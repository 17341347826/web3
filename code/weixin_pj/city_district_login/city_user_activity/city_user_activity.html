<div ms-important="city_user_activity" id="city_user_activity">
    <div class="weui-cells give-out-cells">
        <div class="weui-cell weui-cell_select weui-cell_select-after">
            <div class="weui-cell__hd">
                <label class="weui-label" for="select1">
                    年级：
                </label>
            </div>
            <div class="weui-cell__bd">
                <select class="weui-select" data-duplex-changed="@grade_check()" id="select1"
                        ms-duplex="@grade_info">
                    <!--ms-for: el in @grade_list-->
                    <option ms-attr="{value:el.name+'|'+el.value}">
                        {{el.name}}
                    </option>
                    <!--ms-for-end:-->
                </select>
            </div>
        </div>
    </div>
    <!--结果生成进度（全市）-->
    <div class="progess-con">
        <div class="tips" ms-if="@data_school.list.length>0">说明：以下为学生、家长、教师七日内登录人数与总人数的比率，七日内重复登陆只计算一次</div>
        <div class="progress-person" ms-if="@user_level<3 && @data_city.list.length>0">
            <div class="table-name">用户活跃度（全市）</div>
            <div class="table-module">
                <table class="table-class">
                    <tbody>
                    <tr>
                        <td>单位</td>
                        <td>年级</td>
                        <td>教师</td>
                        <td>学生</td>
                        <td>家长</td>
                    </tr>
                    <tr ms-for="$idx,el in @filter_city(@data_city.list)">
                        <td  ms-if="$idx==0||el.city != @data_city.list[$idx-1].city"
                             ms-attr="{rowspan:@count(@filter_city(@data_city.list), 'city', el.city)}">
                            {{el.city}}
                        </td>
                        <td>{{el.grade}}</td>
                        <td>{{(el.tch_logins/el.tch_cnt) | rj_filter}}%</td>
                        <td>{{(el.stu_logins/el.stu_cnt) | rj_filter}}%</td>
                        <td>{{(el.par_logins/el.par_cnt) | rj_filter}}%</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="progress-person" :if="@data_area.list.length>0">
            <div class="table-name">用户活跃度（区县）</div>
            <!--筛选条件-->
            <div class="common-select" ms-if="@user_level<3">
                <div class="search-cont clearfix">
                    <!--区县-->
                    <div class="select">
                        <label>区县：</label>
                        <div class="old-select">
                            <select data-duplex-changed="@area_check" ms-duplex="@area_area">
                                <!--ms-for: el in @area_list-->
                                <option ms-attr="{value:el.name+'|'+el.value}">
                                    {{el.name}}
                                </option>
                                <!--ms-for-end:-->
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            <div class="table-module">
                <table class="table-class">
                    <tbody>
                    <tr>
                        <td>单位</td>
                        <td>年级</td>
                        <td>教师</td>
                        <td>学生</td>
                        <td>家长</td>
                    </tr>
                    <tr ms-for="$idx,el in @filter_area(@data_area.list)">
                        <td  ms-if="$idx==0||el.district != @filter_area(data_area.list)[$idx-1].district"
                             ms-attr="{rowspan:@count(@filter_area(@data_area.list), 'district', el.district)}">
                            {{el.district}}
                        </td>
                        <td>{{el.grade}}</td>
                        <td>{{(el.tch_logins/el.tch_cnt) | rj_filter}}%</td>
                        <td>{{(el.stu_logins/el.stu_cnt) | rj_filter}}%</td>
                        <td>{{(el.par_logins/el.par_cnt) | rj_filter}}%</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="progress-person">
            <div class="table-name">用户活跃度（学校）</div>
            <!--筛选条件-->
            <div class="common-select" >
                <div class="search-cont clearfix">
                    <!--区县-->
                    <div class="select" ms-if="@user_level<3">
                        <label>区县：</label>
                        <div class="old-select">
                            <select data-duplex-changed="@school_area_check" ms-duplex="@school_area">
                                <!--ms-for: el in @area_list-->
                                <option ms-attr="{value:el.name+'|'+el.value}">
                                    {{el.name}}
                                </option>
                                <!--ms-for-end:-->
                            </select>
                        </div>
                    </div>
                    <!--学校-->
                    <div class="form-input">
                        <label>学校：</label>
                        <input type="text" placeholder="请输入学校" ms-duplex="@current_school" ms-on-blur="@search">
                        <!--<div class="search-btn">-->
                            <!--<input type="button" value="查询" ms-on-click="@search">-->
                        <!--</div>-->
                    </div>
                </div>
            </div>
            <div class="table-module">
                <table class="table-class">
                    <tbody>
                    <tr>
                        <td>单位</td>
                        <td>年级</td>
                        <td>总人数</td>
                        <td>未生成人数</td>
                        <td>完成率</td>
                    </tr>
                    <tr ms-for="$idx,el in @filter_school(@data_school.list)">
                        <td ms-if="$idx==0||el.school != @filter_school(data_school.list)[$idx-1].school" ms-attr="{rowspan:@count(@filter_school(@data_school.list), 'school', el.school)}">
                            {{el.school}}
                        </td>
                        <td>{{el.grade}}</td>
                        <td>{{(el.tch_logins/el.tch_cnt) | rj_filter}}%</td>
                        <td>{{(el.stu_logins/el.stu_cnt) | rj_filter}}%</td>
                        <td>{{(el.par_logins/el.par_cnt) | rj_filter}}%</td>
                    </tr>
                    <tr :if="@data_school.list.length == 0">
                        <td colspan="5">暂无数据</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!--暂无数据-->
        <div ms-if="@data_school.list == null && @data_area.list == null && @data_city.list == null" class="no-data">
            <img src="./../../../common/images/weixin_pj/no_data.png" alt="">
        </div>
    </div>

    <!--<div class="weui-loadmore" ms-if="@is_show_loader_more">-->
    <!--<i class="weui-loading">-->
    <!--</i>-->
    <!--<span class="weui-loadmore__tips">-->
    <!--正在加载-->
    <!--</span>-->
    <!--</div>-->
</div>
