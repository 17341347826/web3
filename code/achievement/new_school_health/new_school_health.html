<div ms-important="new_school_health" id="new_school_health">
    <xmp ms-widget="{is:'ms-three-menu-module'}"></xmp>

    <!--引用公共组件-->
    <div class="am-g" style="background-color: white;">
        <div class="search-cont clearfix one_left">
            <div class="select">
                <xmp ms-widget="{is:'ms-select-assembly',is_init:true,data_arr:@grade_list,sel_check:@change_grade,head_value:@head_value.grade, $id:'score_edit_opt_grade'}"></xmp>
            </div>
            <div class="select">
                <xmp ms-widget="{is:'ms-select-assembly',is_init:true,data_arr:@class_list,sel_check:@change_class,head_value:@head_value.class,  $id:'score_edit_opt_class'}"></xmp>
            </div>
            <div class="select">
                <xmp ms-widget="{is:'ms-select-assembly',is_init:true,data_arr:@sem_list,sel_check:@change_sems,head_value:@head_value.semester,  $id:'score_edit_opt_sem'}"></xmp>
            </div>
            <div class="form-input">
                <input type="text" placeholder="请输入学籍号" :duplex="@form_list_score.code__icontains" ms-on-blur="@code_search()">
            </div>
            <div class="form-input">
                <input type="text" placeholder="请输入姓名" :duplex="@form_list_score.name__icontains" ms-on-blur="@name_search()">
            </div>
        </div>

        <div class="search-cont clearfix two_right">
            <!--<div class="search-btn" ms-on-click="@query_score">-->
                <!--<input type="button" value="查询">-->
            <!--</div>-->
            <div class="search-btn" ms-on-click="@input_score">
                <input type="button" value="录入">
            </div>
            <div class="search-btn bulk-load" ms-click="@uploadingModal">
                <input type="button" value="批量导入">
            </div>
            <div class="search-btn bulk-load" :if="@login_level == 4" ms-on-click="@publicity()">
                <input type="button" value="发布公示">
            </div>
            <div class="search-btn bulk-load" :if="@login_level == 4" ms-on-click="@cancel_publicity()">
                <input type="button" value="撤销公示">
            </div>
            <div class="search-btn" :if="@login_level == 6" ms-on-click="@free_test">
                <input type="button" value="免测">
            </div>

        </div>

    </div>
    <div class="content-ach-t">
        <div class="content-ach-o">
            <table class="am-table am-table-bordered am-table-hover">
                <tr class="content-table-tr">
                    <td>序号</td>
                    <td>姓名</td>
                    <td>学籍号</td>
                    <td>性别</td>
                    <td>身高</td>
                    <td>体重</td>
                    <td>体重评分</td>
                    <td>体重等级</td>
                    <td>肺活量</td>
                    <td>肺活量评分</td>
                    <td>肺活量等级</td>
                    <td>50米跑</td>
                    <td>50米跑评分</td>
                    <td>50米跑等级</td>
                    <td>立定跳远</td>
                    <td>立定跳远评分</td>
                    <td>立定跳远等级</td>
                    <td>坐位体前屈</td>
                    <td>坐位体前屈评分</td>
                    <td>坐位体前屈等级</td>
                    <td>800米跑</td>
                    <td>800米跑评分</td>
                    <td>800米跑等级</td>
                    <td>800米跑附加分</td>
                    <td>1000米跑</td>
                    <td>1000米跑评分</td>
                    <td>1000米跑等级</td>
                    <td>1000米跑附加分</td>
                    <td>一分钟仰卧起坐</td>
                    <td>一分钟仰卧起坐评分</td>
                    <td>一分钟仰卧起坐等级</td>
                    <td>一分钟仰卧起坐附加分</td>
                    <td>引体向上</td>
                    <td>引体向上评分</td>
                    <td>引体向上等级</td>
                    <td>引体向上附加分</td>
                    <td>标准分</td>
                    <td>附加分</td>
                    <td>总分</td>
                    <td>总分等级</td>
                    <td>状态</td>
                    <td>操作</td>
                </tr>
                <!--flag_exempt:免考: 0 正常 1 免考(审核通过) 2待审核免考 3 审核不同	-->
                <!--ms-for:($idx,item) in @score_list-->
                <tr :if="item.flag_exempt == 1 || item.flag_exempt == 2">
                    <td>{{$idx+1}}</td>
                    <td>{{item.name}}</td>
                    <td>{{item.code|mtruncate(3,3)}}</td>
                    <td>{{item.sex | sex}}</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>免测</td>
                    <td>{{item.current_process | processFilters}}</td>
                    <td>
                        <!--<a title='不可编辑' class='tab-btn tab-edit-btn-disabled'></a>-->
                        <a title='编辑' class='tab-btn tab-edit-btn' ms-on-click='@score_edit($idx,item)'></a>
                    </td>
                </tr>
                <tr :if="item.flag_exempt != 1 && item.flag_exempt != 2">
                    <td>{{$idx+1}}</td>
                    <td>{{item.name}}</td>
                    <td>{{item.code|mtruncate(3,3)}}</td>
                    <td>{{item.sex | sex}}</td>
                    <td>{{item.height}}</td>
                    <td>{{item.weight}}</td>
                    <td>{{item.weight_score}}</td>
                    <td>{{item.weight_lv}}</td>
                    <td>{{item.vital_capacity}}</td>
                    <td>{{item.vital_capacity_score}}</td>
                    <td>{{item.vital_capacity_lv}}</td>
                    <td>{{item.run_50}}</td>
                    <td>{{item.run_50_score}}</td>
                    <td>{{item.run_50_lv}}</td>
                    <td>{{item.ldty}}</td>
                    <td>{{item.ldty_score}}</td>
                    <td>{{item.ldty_lv}}</td>
                    <td>{{item.zqqq}}</td>
                    <td>{{item.zqqq_score}}</td>
                    <td>{{item.zqqq_lv}}</td>
                    <td>{{item.run_800}}</td>
                    <td>{{item.run_800_score}}</td>
                    <td>{{item.run_800_lv}}</td>
                    <td>{{item.run_800_extra}}</td>
                    <td>{{item.run_1000}}</td>
                    <td>{{item.run_1000_score}}</td>
                    <td>{{item.run_1000_lv}}</td>
                    <td>{{item.run_1000_extra}}</td>
                    <td>{{item.ywqz}}</td>
                    <td>{{item.ywqz_scor}}</td>
                    <td>{{item.ywqz_lv}}</td>
                    <td>{{item.ywqz_extra}}</td>
                    <td>{{item.ytxs}}</td>
                    <td>{{item.ytxs_score}}</td>
                    <td>{{item.ytxs_lv}}</td>
                    <td>{{item.ytxs_extra}}</td>
                    <td>{{item.criteria_score}}</td>
                    <td>{{item.extra_score}}</td>
                    <td>{{item.total_score}}</td>
                    <td>{{item.total_score_lv}}</td>
                    <td>{{item.current_process | processFilters}}</td>
                    <td>
                        <a title='编辑' class='tab-btn tab-edit-btn' ms-on-click='@score_edit($idx,item)'></a>
                    </td>
                </tr>
                <!--ms-for-end:-->
            </table>
        </div>
    </div>
    <!--上传文件-->
    <div class="am-modal am-modal-prompt upload_div" id="file-uploading" tabindex="-1">
        <div class="am-modal-dialog">
            <div class="am-modal-hd">
                批量导入学生成绩
                <a class="am-close am-close-spin" data-am-modal-close="" href="javascript: void(0)">
                    ×
                </a>
            </div>
            <div class="am-modal-bd">
                <form id="uploadForm" method="post" enctype="multipart/form-data">
                    <input type="text" ms-duplex="@file_name" id="file-name" disabled class="am-u-sm-10"
                           style="height: 32px">
                    <div class="am-form-group am-form-file" :visible="!@is_progress_show">
                        <button type="button" class="am-btn am-btn-default am-btn-sm">选择文件</button>
                        <input type="file" id="file" name="file" multiple
                               onchange="document.getElementById('file-name').value=this.value">
                        <input type="hidden" name="semester_id" ms-attr="{value:@current_semester_id}">
                        <input type="hidden" name="semester_year" ms-attr="{value:@current_semster_year}">
                    </div>
                </form>
                <!--校管理员导入体质测评成绩给出提示-->
                <div class="am-text-left" :if="@login_level == 4" style="color:red;font-size:12px;display:inline-block;">
                    <span>
                        注意：学校系统管理员统一导入时，需导入全年级学生，在发布前每次导入会覆盖上一次
                        导入数据；每次导入只会导入当前学期数据
                    </span>
                </div>
                <div class="am-text-left" :visible="!@is_progress_show">
                    <a ms-on-click="@down_score">
                        下载模板
                    </a>
                </div>
                <!--<span ms-visible="@modal.msg != ''" style="color: red">-->
                    <!--{{ @modal.msg }}-->
                <!--</span>-->
                <!--加载进度条-->
                <div :visible="@is_progress_show" class="sj-tj">数据导入中，请等待...</div>
                <div :visible="@is_progress_show" class="am-progress am-progress-striped am-progress-sm am-active">
                    <div class="am-progress-bar am-progress-bar-secondary" :css="{width:@progress_scale}">{{@progress_scale}}</div>
                </div>
                <div ms-if="@error_has" class="am-text-left" style="margin-top:10px;margin-botttom:5px;">错误信息，请检查：</div>
                <div ms-if="@error_has" ms-html="@modal.msg"  style="color: red;max-height: 300px;overflow: auto;"></div>
            </div>
            <div class="am-modal-footer" :visible="!@is_progress_show">
                    <span class="am-modal-btn" data-am-modal-cancel="">
                        取消
                    </span>
                <span class="am-modal-btn" data-am-modal-confirm="" ms-on-click="@uploading()">
                        上传
                </span>
            </div>
        </div>
    </div>
</div>